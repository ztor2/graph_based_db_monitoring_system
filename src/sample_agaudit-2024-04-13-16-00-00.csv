2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,1,"SELECT",2024-04-13 16:02:12 KST,3/330,0,AUDIT,00000,"""
                    SELECT customer_id, COUNT(rental_id) AS total_rentals
FROM rental
GROUP BY customer_id;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,2,"SELECT",2024-04-13 16:02:12 KST,3/331,0,AUDIT,00000,"""
                    SELECT inventory.film_id, AVG(return_date - rental_date) AS average_rental_duration
FROM rental
JOIN inventory ON rental.inventory_id = inventory.inventory_id
GROUP BY inventory.film_id;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,3,"SELECT",2024-04-13 16:02:12 KST,3/332,0,AUDIT,00000,"""
                    WITH GenreCounts AS (
  SELECT 
    rental.customer_id, 
    category.name AS genre, 
    COUNT(*) AS genre_count,
    MAX(COUNT(*)) OVER (PARTITION BY rental.customer_id) AS max_genre_count
  FROM rental
  JOIN inventory ON rental.inventory_id = inventory.inventory_id
  JOIN film_category ON inventory.film_id = film_category.film_id
  JOIN category ON film_category.category_id = category.category_id
  GROUP BY rental.customer_id, category.name
)
SELECT 
  customer_id, 
  genre, 
  genre_count AS max_genre_count
FROM GenreCounts
WHERE genre_count = max_genre_count;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,4,"SELECT",2024-04-13 16:02:12 KST,3/333,0,AUDIT,00000,"""
                    SELECT EXTRACT(YEAR FROM rental_date) AS rental_year, EXTRACT(MONTH FROM rental_date) AS rental_month, COUNT(rental_id) AS total_rentals
FROM rental
GROUP BY rental_year, rental_month;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,5,"SELECT",2024-04-13 16:02:12 KST,3/334,0,AUDIT,00000,"""
                    SELECT film.film_id, title, SUM(amount) AS total_revenue
FROM payment
JOIN rental ON payment.rental_id = rental.rental_id
JOIN inventory ON rental.inventory_id = inventory.inventory_id
JOIN film ON inventory.film_id = film.film_id
GROUP BY film.film_id, title;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,6,"SELECT",2024-04-13 16:02:12 KST,3/335,0,AUDIT,00000,"""
                    SELECT customer_id, inventory.film_id, title, MAX(rental_date) AS last_rental_date
FROM rental
JOIN inventory ON rental.inventory_id = inventory.inventory_id
JOIN film ON inventory.film_id = film.film_id
GROUP BY customer_id, inventory.film_id, title;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,7,"SELECT",2024-04-13 16:02:12 KST,3/336,0,AUDIT,00000,"""
                    SELECT film_id, AVG(rental_count) AS avg_rental_count, AVG(revenue) AS avg_revenue
FROM (
  SELECT film.film_id, COUNT(rental.rental_id) AS rental_count, SUM(payment.amount) AS revenue
  FROM film
  JOIN inventory ON film.film_id = inventory.film_id
  JOIN rental ON inventory.inventory_id = rental.inventory_id
  JOIN payment ON rental.rental_id = payment.rental_id
  GROUP BY film.film_id
) AS film_stats
GROUP BY film_id;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,8,"SELECT",2024-04-13 16:02:12 KST,3/337,0,AUDIT,00000,"""
                    SELECT customer_id, SUM(amount) AS total_spent
FROM payment
GROUP BY customer_id
ORDER BY total_spent DESC
LIMIT 10;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,9,"SELECT",2024-04-13 16:02:12 KST,3/338,0,AUDIT,00000,"""
                    SELECT category.name AS category, AVG(return_date - rental_date) AS average_rental_duration
FROM rental
JOIN inventory ON rental.inventory_id = inventory.inventory_id
JOIN film_category ON inventory.film_id = film_category.film_id
JOIN category ON film_category.category_id = category.category_id
GROUP BY category.name;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,10,"SELECT",2024-04-13 16:02:12 KST,3/339,0,AUDIT,00000,"""
                    SELECT customer_id, store_id, COUNT(store_id) AS visit_count
FROM rental
JOIN staff ON rental.staff_id = staff.staff_id
GROUP BY customer_id, store_id
ORDER BY visit_count DESC;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,11,"SELECT",2024-04-13 16:02:12 KST,3/340,0,AUDIT,00000,"""
                    SELECT store.store_id, SUM(payment.amount) AS total_revenue
FROM payment
JOIN staff ON payment.staff_id = staff.staff_id
JOIN store ON staff.store_id = store.store_id
GROUP BY store.store_id;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,12,"SELECT",2024-04-13 16:02:12 KST,3/341,0,AUDIT,00000,"""
                    SELECT actor.actor_id, actor.first_name, actor.last_name, COUNT(film_actor.actor_id) AS total_rentals
FROM rental
JOIN inventory ON rental.inventory_id = inventory.inventory_id
JOIN film_actor ON inventory.film_id = film_actor.film_id
JOIN actor ON film_actor.actor_id = actor.actor_id
GROUP BY actor.actor_id
ORDER BY total_rentals DESC
LIMIT 10;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,13,"SELECT",2024-04-13 16:02:12 KST,3/342,0,AUDIT,00000,"""
                    SELECT customer_id, SUM(film.length) AS total_length
FROM rental
JOIN inventory ON rental.inventory_id = inventory.inventory_id
JOIN film ON inventory.film_id = film.film_id
GROUP BY customer_id;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,14,"SELECT",2024-04-13 16:02:12 KST,3/343,0,AUDIT,00000,"""
                    SELECT category.name AS category, film.title AS film_title, COUNT(rental.rental_id) AS rental_count
FROM rental
JOIN inventory ON rental.inventory_id = inventory.inventory_id
JOIN film ON inventory.film_id = film.film_id
JOIN film_category ON film.film_id = film_category.film_id
JOIN category ON film_category.category_id = category.category_id
GROUP BY category.name, film.title
ORDER BY category.name, rental_count DESC;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,15,"SELECT",2024-04-13 16:02:12 KST,3/344,0,AUDIT,00000,"""
                    SELECT COUNT(DISTINCT film.film_id) AS total_films_rented, AVG(film.rental_rate) AS average_rental_rate
FROM rental
JOIN inventory ON rental.inventory_id = inventory.inventory_id
JOIN film ON inventory.film_id = film.film_id;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,16,"SELECT",2024-04-13 16:02:12 KST,3/345,0,AUDIT,00000,"""
                    SELECT category.name, AVG(film.rental_rate) AS average_rental_rate
FROM category
JOIN film_category ON category.category_id = film_category.category_id
JOIN film ON film_category.film_id = film.film_id
GROUP BY category.name;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,17,"SELECT",2024-04-13 16:02:12 KST,3/346,0,AUDIT,00000,"""
                    SELECT customer_id, film.title, COUNT(rental.rental_id) AS rental_count
FROM rental
INNER JOIN inventory ON rental.inventory_id = inventory.inventory_id
INNER JOIN film ON inventory.film_id = film.film_id
GROUP BY customer_id, film.title
ORDER BY rental_count DESC;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,18,"SELECT",2024-04-13 16:02:12 KST,3/347,0,AUDIT,00000,"""
                    SELECT category.name AS category_name, film.title, film.length AS min_length
FROM film
JOIN film_category ON film.film_id = film_category.film_id
JOIN category ON film_category.category_id = category.category_id
JOIN (
    SELECT film_category.category_id, MIN(film.length) AS min_length
    FROM film
    JOIN film_category ON film.film_id = film_category.film_id
    GROUP BY film_category.category_id
) AS min_length_films ON film_category.category_id = min_length_films.category_id AND film.length = min_length_films.min_length;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,19,"SELECT",2024-04-13 16:02:12 KST,3/348,0,AUDIT,00000,"""
                    SELECT inventory.film_id, COUNT(rental.rental_id) AS rental_count
FROM rental
JOIN inventory ON rental.inventory_id = inventory.inventory_id
WHERE rental.rental_date BETWEEN DATE_TRUNC('year', CURRENT_DATE) - INTERVAL '1 year' AND DATE_TRUNC('year', CURRENT_DATE)
GROUP BY inventory.film_id
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,20,"SELECT",2024-04-13 16:02:12 KST,3/349,0,AUDIT,00000,"""
                    SELECT film.title, SUM(payment.amount) AS total_income
FROM film
JOIN inventory ON film.film_id = inventory.film_id
JOIN rental ON inventory.inventory_id = rental.inventory_id
JOIN payment ON rental.rental_id = payment.rental_id
GROUP BY film.title;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,21,"SELECT",2024-04-13 16:02:12 KST,3/350,0,AUDIT,00000,"""
                    SELECT AVG(return_date - rental_date) AS average_rental_duration
FROM rental;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,22,"SELECT",2024-04-13 16:02:12 KST,3/351,0,AUDIT,00000,"""
                    SELECT store.store_id, COUNT(rental.rental_id) AS rental_count
FROM store
JOIN inventory ON store.store_id = inventory.store_id
JOIN rental ON inventory.inventory_id = rental.inventory_id
GROUP BY store.store_id;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,23,"SELECT",2024-04-13 16:02:12 KST,3/352,0,AUDIT,00000,"""
                    SELECT actor.actor_id, actor.first_name, actor.last_name, COUNT(film_actor.film_id) AS film_count
FROM actor
JOIN film_actor ON actor.actor_id = film_actor.actor_id
GROUP BY actor.actor_id, actor.first_name, actor.last_name;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,24,"SELECT",2024-04-13 16:02:12 KST,3/353,0,AUDIT,00000,"""
                    SELECT film.title, COUNT(rental.rental_id) AS rental_count
FROM film
JOIN inventory ON film.film_id = inventory.film_id
JOIN rental ON inventory.inventory_id = rental.inventory_id
GROUP BY film.title
ORDER BY rental_count DESC
LIMIT 1;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,25,"SELECT",2024-04-13 16:02:12 KST,3/354,0,AUDIT,00000,"""
                    SELECT customer_id, SUM(amount) AS total_payment
FROM payment
GROUP BY customer_id;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,26,"SELECT",2024-04-13 16:02:12 KST,3/355,0,AUDIT,00000,"""
                    SELECT actor.actor_id, CONCAT(actor.first_name, ' ', actor.last_name) AS actor_name, film.title
FROM actor
JOIN film_actor ON actor.actor_id = film_actor.actor_id
JOIN film ON film_actor.film_id = film.film_id
WHERE CONCAT(actor.first_name, ' ', actor.last_name) = 'Matthew Johansson';
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,27,"SELECT",2024-04-13 16:02:12 KST,3/356,0,AUDIT,00000,"""
                    SELECT film.title, COUNT(rental.rental_id) AS rental_count
FROM rental
JOIN inventory ON rental.inventory_id = inventory.inventory_id
JOIN film ON inventory.film_id = film.film_id
GROUP BY film.title
ORDER BY rental_count DESC
LIMIT 10;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,28,"SELECT",2024-04-13 16:02:12 KST,3/357,0,AUDIT,00000,"""
                    SELECT category.name AS category_name,
       AVG(rental.return_date - rental.rental_date) AS average_rental_duration
FROM category
JOIN film_category ON category.category_id = film_category.category_id
JOIN film ON film_category.film_id = film.film_id
JOIN inventory ON film.film_id = inventory.film_id
JOIN rental ON inventory.inventory_id = rental.inventory_id
WHERE rental.return_date IS NOT NULL
GROUP BY category.name;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,29,"SELECT",2024-04-13 16:02:12 KST,3/358,0,AUDIT,00000,"""
                    WITH ranked_categories AS (
  SELECT 
    rental.customer_id, 
    category.name AS category_name, 
    COUNT(*) AS category_count,
    RANK() OVER (PARTITION BY rental.customer_id ORDER BY COUNT(*) DESC) AS rank
  FROM rental
  JOIN inventory ON rental.inventory_id = inventory.inventory_id
  JOIN film ON inventory.film_id = film.film_id
  JOIN film_category ON film.film_id = film_category.film_id
  JOIN category ON film_category.category_id = category.category_id
  GROUP BY rental.customer_id, category.name
)
SELECT 
  customer.customer_id, 
  CONCAT(customer.first_name, ' ', customer.last_name) AS full_name, 
  category_name AS favorite_category, 
  category_count AS max_rental_count
FROM ranked_categories
JOIN customer ON ranked_categories.customer_id = customer.customer_id
WHERE rank = 1
ORDER BY customer.customer_id;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,30,"SELECT",2024-04-13 16:02:12 KST,3/359,0,AUDIT,00000,"""
                    SELECT actor.first_name, actor.last_name, AVG(film.rental_rate) AS average_rental_rate
FROM actor
JOIN film_actor ON actor.actor_id = film_actor.actor_id
JOIN film ON film_actor.film_id = film.film_id
GROUP BY actor.actor_id;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,31,"SELECT",2024-04-13 16:02:12 KST,3/360,0,AUDIT,00000,"""
                    SELECT store.store_id, SUM(payment.amount) AS total_revenue
FROM store
JOIN staff ON store.store_id = staff.store_id
JOIN payment ON staff.staff_id = payment.staff_id
GROUP BY store.store_id;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,32,"SELECT",2024-04-13 16:02:12 KST,3/361,0,AUDIT,00000,"""
                    SELECT customer.customer_id, CONCAT(customer.first_name, ' ', customer.last_name) AS full_name, MAX(rental.rental_date) AS last_rental_date
FROM customer
JOIN rental ON customer.customer_id = rental.customer_id
GROUP BY customer.customer_id;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,33,"SELECT",2024-04-13 16:02:12 KST,3/362,0,AUDIT,00000,"""
                    SELECT category.name AS category_name, film.title, COUNT(rental.rental_id) AS rental_count
FROM category
JOIN film_category ON category.category_id = film_category.category_id
JOIN film ON film_category.film_id = film.film_id
JOIN inventory ON film.film_id = inventory.film_id
JOIN rental ON inventory.inventory_id = rental.inventory_id
GROUP BY category.name, film.title
ORDER BY category.name, rental_count DESC;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,34,"SELECT",2024-04-13 16:02:12 KST,3/363,0,AUDIT,00000,"""
                    SELECT film.title, COUNT(rental.rental_id) AS rental_count
FROM film
JOIN inventory ON film.film_id = inventory.film_id
JOIN rental ON inventory.inventory_id = rental.inventory_id
WHERE rental.rental_date BETWEEN '2006-01-01' AND '2006-12-31'
GROUP BY film.title
ORDER BY rental_count DESC
LIMIT 10;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,35,"SELECT",2024-04-13 16:02:12 KST,3/364,0,AUDIT,00000,"""
                    SELECT customer.customer_id, CONCAT(customer.first_name, ' ', customer.last_name) AS full_name, SUM(payment.amount) AS total_amount_paid
FROM customer
JOIN payment ON customer.customer_id = payment.customer_id
GROUP BY customer.customer_id
ORDER BY total_amount_paid DESC;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,36,"SELECT",2024-04-13 16:02:12 KST,3/365,0,AUDIT,00000,"""
                    SELECT actor.first_name, actor.last_name, COUNT(film_actor.film_id) AS film_count
FROM actor
JOIN film_actor ON actor.actor_id = film_actor.actor_id
GROUP BY actor.actor_id
ORDER BY film_count DESC;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,37,"SELECT",2024-04-13 16:02:12 KST,3/366,0,AUDIT,00000,"""
                    SELECT actor.first_name, actor.last_name, film.title
FROM actor
JOIN film_actor ON actor.actor_id = film_actor.actor_id
JOIN film ON film_actor.film_id = film.film_id
WHERE actor.first_name = 'Penelope' AND actor.last_name = 'Guiness';
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,38,"SELECT",2024-04-13 16:02:12 KST,3/367,0,AUDIT,00000,"""
                    SELECT customer.customer_id, customer.first_name, customer.last_name, address.address, city.city
FROM customer
JOIN address ON customer.address_id = address.address_id
JOIN city ON address.city_id = city.city_id;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,39,"SELECT",2024-04-13 16:02:12 KST,3/368,0,AUDIT,00000,"""
                    SELECT city.city, COUNT(customer.customer_id) AS customer_count
FROM customer
JOIN address ON customer.address_id = address.address_id
JOIN city ON address.city_id = city.city_id
GROUP BY city.city;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,40,"SELECT",2024-04-13 16:02:12 KST,3/369,0,AUDIT,00000,"""
                    SELECT SUM(film.rental_rate) AS total_rental_income
FROM film;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,41,"SELECT",2024-04-13 16:02:12 KST,3/370,0,AUDIT,00000,"""
                    SELECT customer.customer_id, CONCAT(customer.first_name, ' ', customer.last_name) AS full_name, AVG(film.length) AS average_length
FROM customer
JOIN rental ON customer.customer_id = rental.customer_id
JOIN inventory ON rental.inventory_id = inventory.inventory_id
JOIN film ON inventory.film_id = film.film_id
GROUP BY customer.customer_id;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,42,"SELECT",2024-04-13 16:02:12 KST,3/371,0,AUDIT,00000,"""
                    SELECT film.title, film.release_year
FROM film
JOIN film_actor ON film.film_id = film_actor.film_id
JOIN actor ON film_actor.actor_id = actor.actor_id
WHERE actor.first_name = 'Penelope' AND actor.last_name = 'Guiness'
ORDER BY film.release_year;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,43,"SELECT",2024-04-13 16:02:12 KST,3/372,0,AUDIT,00000,"""
                    SELECT category.name AS genre, COUNT(rental.rental_id) AS rental_count
FROM category
JOIN film_category ON category.category_id = film_category.category_id
JOIN film ON film_category.film_id = film.film_id
JOIN inventory ON film.film_id = inventory.film_id
JOIN rental ON inventory.inventory_id = rental.inventory_id
GROUP BY category.name
ORDER BY rental_count DESC
LIMIT 5;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,44,"SELECT",2024-04-13 16:02:12 KST,3/373,0,AUDIT,00000,"""
                    SELECT title, release_year, length
FROM film
WHERE release_year = 2006
ORDER BY length DESC
LIMIT 1;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,45,"SELECT",2024-04-13 16:02:12 KST,3/374,0,AUDIT,00000,"""
                    SELECT staff.staff_id, CONCAT(staff.first_name, ' ', staff.last_name) AS full_name, SUM(payment.amount) AS total_sales
FROM staff
JOIN payment ON staff.staff_id = payment.staff_id
GROUP BY staff.staff_id;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,46,"SELECT",2024-04-13 16:02:12 KST,3/375,0,AUDIT,00000,"""
                    SELECT customer.customer_id, film.title, COUNT(rental.rental_id) AS rental_count
FROM rental
JOIN customer ON rental.customer_id = customer.customer_id
JOIN inventory ON rental.inventory_id = inventory.inventory_id
JOIN film ON inventory.film_id = film.film_id
GROUP BY customer.customer_id, film.title
ORDER BY customer.customer_id, rental_count DESC;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,47,"SELECT",2024-04-13 16:02:12 KST,3/376,0,AUDIT,00000,"""
                    SELECT c.customer_id, c.first_name, c.last_name, COUNT(r.rental_id) AS total_rentals
FROM customer c
JOIN rental r ON c.customer_id = r.customer_id
GROUP BY c.customer_id
ORDER BY total_rentals DESC
LIMIT 10;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,48,"SELECT",2024-04-13 16:02:12 KST,3/377,0,AUDIT,00000,"""
                    SELECT c.name AS category_name, AVG(f.rental_rate) AS avg_rental_rate
FROM category c
JOIN film_category fc ON c.category_id = fc.category_id
JOIN film f ON fc.film_id = f.film_id
GROUP BY c.name;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,49,"SELECT",2024-04-13 16:02:12 KST,3/378,0,AUDIT,00000,"""
                    SELECT EXTRACT(YEAR FROM r.rental_date) AS rental_year, COUNT(r.rental_id) AS total_rentals
FROM rental r
GROUP BY rental_year
ORDER BY rental_year;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,50,"SELECT",2024-04-13 16:02:12 KST,3/379,0,AUDIT,00000,"""
                    SELECT st.store_id, c.city, COUNT(r.rental_id) AS total_rentals
FROM store st
JOIN staff s ON st.store_id = s.store_id
JOIN rental r ON s.staff_id = r.staff_id
JOIN address a ON st.address_id = a.address_id
JOIN city c ON a.city_id = c.city_id
GROUP BY st.store_id, c.city
ORDER BY total_rentals DESC;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,51,"SELECT",2024-04-13 16:02:12 KST,3/380,0,AUDIT,00000,"""
                    SELECT c.first_name, c.last_name, COUNT(p.payment_id) AS total_payments, SUM(p.amount) AS total_amount
FROM customer c
JOIN rental r ON c.customer_id = r.customer_id
JOIN payment p ON r.rental_id = p.rental_id
GROUP BY c.customer_id
ORDER BY total_amount DESC
LIMIT 10;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,52,"SELECT",2024-04-13 16:02:12 KST,3/381,0,AUDIT,00000,"""
                    SELECT c.name AS category_name, COUNT(DISTINCT f.film_id) AS num_films
FROM category c
JOIN film_category fc ON c.category_id = fc.category_id
JOIN film f ON fc.film_id = f.film_id
GROUP BY c.name
ORDER BY num_films DESC;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,53,"SELECT",2024-04-13 16:02:12 KST,3/382,0,AUDIT,00000,"""
                    SELECT DATE_PART('month', r.rental_date) AS rental_month, DATE_PART('year', r.rental_date) AS rental_year, COUNT(r.rental_id) AS total_rentals
FROM rental r
GROUP BY rental_month, rental_year
ORDER BY rental_year, rental_month;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,54,"SELECT",2024-04-13 16:02:12 KST,3/383,0,AUDIT,00000,"""
                    SELECT a.district, COUNT(c.customer_id) AS num_customers
FROM address a
JOIN customer c ON a.address_id = c.address_id
GROUP BY a.district
ORDER BY num_customers DESC;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,55,"SELECT",2024-04-13 16:02:12 KST,3/384,0,AUDIT,00000,"""
                    SELECT f.rating, ROUND(AVG(f.length), 2) AS avg_length
FROM film f
GROUP BY f.rating
ORDER BY avg_length DESC;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,56,"SELECT",2024-04-13 16:02:12 KST,3/385,0,AUDIT,00000,"""
                    SELECT s.store_id, ci.city, COUNT(r.rental_id) AS total_rentals
FROM store s
JOIN address a ON s.address_id = a.address_id
JOIN city ci ON a.city_id = ci.city_id
JOIN staff st ON s.store_id = st.store_id
JOIN rental r ON st.staff_id = r.staff_id
GROUP BY s.store_id, ci.city
ORDER BY total_rentals DESC;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,57,"SELECT",2024-04-13 16:02:12 KST,3/386,0,AUDIT,00000,"""
                    SELECT c.name AS category_name, AVG(f.rental_rate) AS avg_rental_rate, AVG(f.length) AS avg_length
FROM category c
JOIN film_category fc ON c.category_id = fc.category_id
JOIN film f ON fc.film_id = f.film_id
GROUP BY c.name
ORDER BY avg_rental_rate DESC;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,58,"SELECT",2024-04-13 16:02:12 KST,3/387,0,AUDIT,00000,"""
                    SELECT c.first_name, c.last_name, COUNT(DISTINCT r.staff_id) AS num_staff_served
FROM customer c
JOIN rental r ON c.customer_id = r.customer_id
GROUP BY c.customer_id
ORDER BY num_staff_served DESC
LIMIT 10;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,59,"SELECT",2024-04-13 16:02:12 KST,3/388,0,AUDIT,00000,"""
                    SELECT f.title, COUNT(r.rental_id) AS total_rentals, SUM(p.amount) AS total_revenue
FROM film f
JOIN inventory i ON f.film_id = i.film_id
JOIN rental r ON i.inventory_id = r.inventory_id
JOIN payment p ON r.rental_id = p.rental_id
GROUP BY f.title
ORDER BY total_revenue DESC
LIMIT 5;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,60,"SELECT",2024-04-13 16:02:12 KST,3/389,0,AUDIT,00000,"""
                    SELECT c.name AS category_name, COUNT(DISTINCT ac.actor_id) AS num_actors
FROM category c
JOIN film_category fc ON c.category_id = fc.category_id
JOIN film f ON fc.film_id = f.film_id
JOIN film_actor fa ON f.film_id = fa.film_id
JOIN actor ac ON fa.actor_id = ac.actor_id
GROUP BY c.name
ORDER BY num_actors DESC;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,61,"SELECT",2024-04-13 16:02:12 KST,3/390,0,AUDIT,00000,"""
                    SELECT c.country, COUNT(DISTINCT cu.customer_id) AS num_customers
FROM country c
JOIN city ci ON c.country_id = ci.country_id
JOIN address a ON ci.city_id = a.city_id
JOIN customer cu ON a.address_id = cu.address_id
GROUP BY c.country
ORDER BY num_customers DESC;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,62,"SELECT",2024-04-13 16:02:12 KST,3/391,0,AUDIT,00000,"""
                    SELECT DATE_PART('year', r.rental_date) AS rental_year, SUM(p.amount) AS total_revenue
FROM rental r
JOIN payment p ON r.rental_id = p.rental_id
GROUP BY rental_year
ORDER BY rental_year;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,63,"SELECT",2024-04-13 16:02:12 KST,3/392,0,AUDIT,00000,"""
                    SELECT c.first_name, c.last_name, COUNT(r.rental_id) AS total_rentals, MAX(r.rental_date) AS last_rental_date
FROM customer c
JOIN rental r ON c.customer_id = r.customer_id
GROUP BY c.customer_id
ORDER BY total_rentals DESC
LIMIT 10;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,64,"SELECT",2024-04-13 16:02:12 KST,3/393,0,AUDIT,00000,"""
                    SELECT f.rating, COUNT(DISTINCT f.language_id) AS num_languages
FROM film f
GROUP BY f.rating
ORDER BY num_languages DESC;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,65,"SELECT",2024-04-13 16:02:12 KST,3/394,0,AUDIT,00000,"""
                    SELECT st.store_id, ci.city, COUNT(DISTINCT c.customer_id) AS num_customers
FROM store st
JOIN staff s ON st.store_id = s.store_id
JOIN rental r ON s.staff_id = r.staff_id
JOIN customer c ON r.customer_id = c.customer_id
JOIN address a ON st.address_id = a.address_id
JOIN city ci ON a.city_id = ci.city_id
GROUP BY st.store_id, ci.city
ORDER BY num_customers DESC;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,66,"SELECT",2024-04-13 16:02:12 KST,3/395,0,AUDIT,00000,"""
                    SELECT c.name AS category_name, COUNT(DISTINCT f.film_id) AS num_films, AVG(f.length) AS avg_length
FROM category c
JOIN film_category fc ON c.category_id = fc.category_id
JOIN film f ON fc.film_id = f.film_id
GROUP BY c.name
ORDER BY num_films DESC;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,67,"SELECT",2024-04-13 16:02:12 KST,3/396,0,AUDIT,00000,"""
                    SELECT c.first_name, c.last_name, COUNT(r.rental_id) AS total_rentals,
       AVG(r.return_date - r.rental_date) AS avg_rental_days
FROM customer c
JOIN rental r ON c.customer_id = r.customer_id
GROUP BY c.customer_id, c.first_name, c.last_name
ORDER BY avg_rental_days DESC
LIMIT 10;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,68,"SELECT",2024-04-13 16:02:12 KST,3/397,0,AUDIT,00000,"""
                    SELECT c.name AS category_name, COUNT(DISTINCT ac.actor_id) AS num_actors, COUNT(DISTINCT f.language_id) AS num_languages
FROM category c
JOIN film_category fc ON c.category_id = fc.category_id
JOIN film f ON fc.film_id = f.film_id
JOIN film_actor fa ON f.film_id = fa.film_id
JOIN actor ac ON fa.actor_id = ac.actor_id
GROUP BY c.name
ORDER BY num_actors DESC, num_languages DESC;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,69,"SELECT",2024-04-13 16:02:12 KST,3/398,0,AUDIT,00000,"""
                    SELECT c.first_name, c.last_name, COUNT(r.rental_id) AS total_rentals, SUM(p.amount) AS total_spent
FROM customer c
JOIN rental r ON c.customer_id = r.customer_id
JOIN payment p ON r.rental_id = p.rental_id
GROUP BY c.customer_id
ORDER BY total_spent DESC
LIMIT 10;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,70,"SELECT",2024-04-13 16:02:12 KST,3/399,0,AUDIT,00000,"""
                    SELECT DATE_PART('month', r.rental_date) AS rental_month, DATE_PART('year', r.rental_date) AS rental_year, COUNT(DISTINCT c.customer_id) AS num_customers
FROM rental r
JOIN customer c ON r.customer_id = c.customer_id
GROUP BY rental_month, rental_year
ORDER BY rental_year, rental_month;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,71,"SELECT",2024-04-13 16:02:12 KST,3/400,0,AUDIT,00000,"""
                    SELECT c.country, COUNT(DISTINCT ci.city_id) AS num_cities, COUNT(DISTINCT cu.customer_id) AS num_customers
FROM country c
JOIN city ci ON c.country_id = ci.country_id
JOIN address a ON ci.city_id = a.city_id
JOIN customer cu ON a.address_id = cu.address_id
GROUP BY c.country
ORDER BY num_customers DESC;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,72,"SELECT",2024-04-13 16:02:12 KST,3/401,0,AUDIT,00000,"""
                    SELECT f.title, COUNT(r.rental_id) AS total_rentals,
       AVG(r.return_date - r.rental_date) AS avg_rental_days
FROM film f
JOIN inventory i ON f.film_id = i.film_id
JOIN rental r ON i.inventory_id = r.inventory_id
GROUP BY f.title
ORDER BY avg_rental_days DESC
LIMIT 10;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,73,"SELECT",2024-04-13 16:02:12 KST,3/402,0,AUDIT,00000,"""
                    SELECT s.store_id, COUNT(DISTINCT r.customer_id) AS num_customers
FROM store s
JOIN staff st ON s.store_id = st.store_id
JOIN rental r ON st.staff_id = r.staff_id
GROUP BY s.store_id
ORDER BY num_customers DESC;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,74,"SELECT",2024-04-13 16:02:12 KST,3/403,0,AUDIT,00000,"""
                    SELECT c.name AS category_name, COUNT(DISTINCT f.language_id) AS num_languages, COUNT(DISTINCT ac.last_name) AS num_last_names
FROM category c
JOIN film_category fc ON c.category_id = fc.category_id
JOIN film f ON fc.film_id = f.film_id
JOIN film_actor fa ON f.film_id = fa.film_id
JOIN actor ac ON fa.actor_id = ac.actor_id
GROUP BY c.name
ORDER BY num_languages DESC, num_last_names DESC;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,75,"SELECT",2024-04-13 16:02:12 KST,3/404,0,AUDIT,00000,"""
                    SELECT c.first_name, c.last_name, COUNT(r.rental_id) AS total_rentals, MAX(r.rental_date) AS last_rental_date, MIN(r.rental_date) AS first_rental_date
FROM customer c
JOIN rental r ON c.customer_id = r.customer_id
GROUP BY c.customer_id
ORDER BY total_rentals DESC
LIMIT 10;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,76,"SELECT",2024-04-13 16:02:12 KST,3/405,0,AUDIT,00000,"""
                    SELECT c.name AS category_name, COUNT(DISTINCT f.rating) AS num_ratings
FROM category c
JOIN film_category fc ON c.category_id = fc.category_id
JOIN film f ON fc.film_id = f.film_id
GROUP BY c.name
ORDER BY num_ratings DESC;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,77,"SELECT",2024-04-13 16:02:12 KST,3/406,0,AUDIT,00000,"""
                    SELECT ac.first_name, ac.last_name, COUNT(DISTINCT f.film_id) AS num_films
FROM actor ac
JOIN film_actor fa ON ac.actor_id = fa.actor_id
JOIN film f ON fa.film_id = f.film_id
GROUP BY ac.actor_id
ORDER BY num_films DESC
LIMIT 10;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,78,"SELECT",2024-04-13 16:02:12 KST,3/407,0,AUDIT,00000,"""
                    SELECT f.rating, COUNT(DISTINCT ac.last_name) AS num_last_names
FROM film f
JOIN film_actor fa ON f.film_id = fa.film_id
JOIN actor ac ON fa.actor_id = ac.actor_id
GROUP BY f.rating
ORDER BY num_last_names DESC;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,79,"SELECT",2024-04-13 16:02:12 KST,3/408,0,AUDIT,00000,"""
                    SELECT c.first_name, c.last_name, COUNT(DISTINCT r.staff_id) AS num_staff_served
FROM customer c
JOIN rental r ON c.customer_id = r.customer_id
GROUP BY c.customer_id
HAVING COUNT(DISTINCT r.staff_id) = (
    SELECT COUNT(DISTINCT staff_id)
    FROM staff
);
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,80,"SELECT",2024-04-13 16:02:12 KST,3/409,0,AUDIT,00000,"""
                    SELECT c.name AS category_name, COUNT(f.film_id) AS num_films, SUM(f.length) AS total_length
FROM category c
JOIN film_category fc ON c.category_id = fc.category_id
JOIN film f ON fc.film_id = f.film_id
GROUP BY c.name
ORDER BY total_length DESC
LIMIT 1;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,81,"SELECT",2024-04-13 16:02:12 KST,3/410,0,AUDIT,00000,"""
                    SELECT ac.first_name, ac.last_name, COUNT(DISTINCT f.language_id) AS num_languages
FROM actor ac
JOIN film_actor fa ON ac.actor_id = fa.actor_id
JOIN film f ON fa.film_id = f.film_id
GROUP BY ac.actor_id
ORDER BY num_languages DESC
LIMIT 10;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,82,"SELECT",2024-04-13 16:02:12 KST,3/411,0,AUDIT,00000,"""
                    SELECT c.name AS category_name, COUNT(DISTINCT f.rating) AS num_ratings, MIN(f.rental_rate) AS min_rental_rate, MAX(f.rental_rate) AS max_rental_rate
FROM category c
JOIN film_category fc ON c.category_id = fc.category_id
JOIN film f ON fc.film_id = f.film_id
GROUP BY c.name;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,83,"SELECT",2024-04-13 16:02:12 KST,3/412,0,AUDIT,00000,"""
                    SELECT DATE_PART('year', r.rental_date) AS rental_year,
       SUM(p.amount) AS total_revenue,
       AVG(r.return_date - r.rental_date) AS avg_rental_days
FROM rental r
JOIN payment p ON r.rental_id = p.rental_id
GROUP BY DATE_PART('year', r.rental_date)
ORDER BY DATE_PART('year', r.rental_date);
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,84,"SELECT",2024-04-13 16:02:12 KST,3/413,0,AUDIT,00000,"""
                    SELECT c.first_name, c.last_name, COUNT(r.rental_id) AS total_rentals,
       MAX(r.return_date - r.rental_date) AS max_rental_days
FROM customer c
JOIN rental r ON c.customer_id = r.customer_id
GROUP BY c.customer_id, c.first_name, c.last_name
ORDER BY max_rental_days DESC
LIMIT 10;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,85,"SELECT",2024-04-13 16:02:12 KST,3/414,0,AUDIT,00000,"""
                    SELECT c.city, COUNT(DISTINCT a.address_id) AS num_addresses, COUNT(DISTINCT cu.customer_id) AS num_customers
FROM city c
JOIN address a ON c.city_id = a.city_id
JOIN customer cu ON a.address_id = cu.address_id
GROUP BY c.city
ORDER BY num_customers DESC;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,86,"SELECT",2024-04-13 16:02:12 KST,3/415,0,AUDIT,00000,"""
                    SELECT c.name AS category_name, COUNT(DISTINCT f.rating) AS num_ratings
FROM category c
JOIN film_category fc ON c.category_id = fc.category_id
JOIN film f ON fc.film_id = f.film_id
GROUP BY c.name
ORDER BY num_ratings DESC;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,87,"SELECT",2024-04-13 16:02:12 KST,3/416,0,AUDIT,00000,"""
                    SELECT c.country, COUNT(DISTINCT a.postal_code) AS num_postal_codes
FROM country c
JOIN city ci ON c.country_id = ci.country_id
JOIN address a ON ci.city_id = a.city_id
GROUP BY c.country
ORDER BY num_postal_codes DESC;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,88,"SELECT",2024-04-13 16:02:12 KST,3/417,0,AUDIT,00000,"""
                    SELECT c.first_name, c.last_name, COUNT(DISTINCT st.staff_id) AS num_staff_served
FROM customer c
JOIN rental r ON c.customer_id = r.customer_id
JOIN staff st ON r.staff_id = st.staff_id
GROUP BY c.customer_id
ORDER BY num_staff_served DESC
LIMIT 10;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,89,"SELECT",2024-04-13 16:02:12 KST,3/418,0,AUDIT,00000,"""
                    SELECT DATE_PART('year', r.rental_date) AS rental_year, COUNT(DISTINCT c.customer_id) AS num_customers
FROM rental r
JOIN customer c ON r.customer_id = c.customer_id
GROUP BY rental_year
ORDER BY rental_year;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,90,"SELECT",2024-04-13 16:02:12 KST,3/419,0,AUDIT,00000,"""
                    SELECT c.name AS category_name, COUNT(DISTINCT f.language_id) AS num_languages, COUNT(DISTINCT ac.last_name) AS num_last_names
FROM category c
JOIN film_category fc ON c.category_id = fc.category_id
JOIN film f ON fc.film_id = f.film_id
LEFT JOIN film_actor fa ON f.film_id = fa.film_id
LEFT JOIN actor ac ON fa.actor_id = ac.actor_id
GROUP BY c.name
ORDER BY num_languages DESC, num_last_names DESC;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,91,"SELECT",2024-04-13 16:02:12 KST,3/420,0,AUDIT,00000,"""
                    SELECT c.first_name, c.last_name, COUNT(r.rental_id) AS total_rentals,
       SUM(p.amount) AS total_spent,
       AVG(r.return_date - r.rental_date) AS avg_rental_days
FROM customer c
JOIN rental r ON c.customer_id = r.customer_id
JOIN payment p ON r.rental_id = p.rental_id
GROUP BY c.customer_id, c.first_name, c.last_name
ORDER BY total_spent DESC
LIMIT 10;

                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,92,"SELECT",2024-04-13 16:02:12 KST,3/421,0,AUDIT,00000,"""
                    SELECT s.store_id, COUNT(DISTINCT r.customer_id) AS num_customers, COUNT(DISTINCT f.film_id) AS num_films_rented
FROM store s
JOIN staff st ON s.store_id = st.store_id
JOIN rental r ON st.staff_id = r.staff_id
JOIN inventory i ON r.inventory_id = i.inventory_id
JOIN film f ON i.film_id = f.film_id
GROUP BY s.store_id
ORDER BY num_customers DESC, num_films_rented DESC;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,93,"SELECT",2024-04-13 16:02:12 KST,3/422,0,AUDIT,00000,"""
                    SELECT c.first_name, c.last_name, COUNT(DISTINCT f.rating) AS num_ratings_rented
FROM customer c
JOIN rental r ON c.customer_id = r.customer_id
JOIN inventory i ON r.inventory_id = i.inventory_id
JOIN film f ON i.film_id = f.film_id
GROUP BY c.customer_id
ORDER BY num_ratings_rented DESC
LIMIT 10;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,94,"SELECT",2024-04-13 16:02:12 KST,3/423,0,AUDIT,00000,"""
                    SELECT c.city, COUNT(DISTINCT a.address_id) AS num_addresses, COUNT(DISTINCT cu.customer_id) AS num_customers
FROM city c
JOIN address a ON c.city_id = a.city_id
JOIN customer cu ON a.address_id = cu.address_id
GROUP BY c.city
ORDER BY num_customers DESC;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,95,"SELECT",2024-04-13 16:02:12 KST,3/424,0,AUDIT,00000,"""
                    SELECT c.name AS category_name, AVG(f.rental_rate) AS avg_rental_rate, PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY f.rental_rate) AS median_rental_rate
FROM category c
JOIN film_category fc ON c.category_id = fc.category_id
JOIN film f ON fc.film_id = f.film_id
GROUP BY c.name;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,96,"SELECT",2024-04-13 16:02:12 KST,3/425,0,AUDIT,00000,"""
                    SELECT c.first_name, c.last_name, COUNT(DISTINCT i.film_id) AS num_films_rented
FROM customer c
JOIN rental r ON c.customer_id = r.customer_id
JOIN inventory i ON r.inventory_id = i.inventory_id
GROUP BY c.customer_id
ORDER BY num_films_rented DESC
LIMIT 10;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,97,"SELECT",2024-04-13 16:02:12 KST,3/426,0,AUDIT,00000,"""
                    SELECT c.name AS category_name, COUNT(DISTINCT f.rating) AS num_ratings, COUNT(DISTINCT f.language_id) AS num_languages
FROM category c
JOIN film_category fc ON c.category_id = fc.category_id
JOIN film f ON fc.film_id = f.film_id
GROUP BY c.name
ORDER BY num_ratings DESC, num_languages DESC;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,98,"SELECT",2024-04-13 16:02:12 KST,3/427,0,AUDIT,00000,"""
                    SELECT ac.first_name, ac.last_name, COUNT(DISTINCT f.rating) AS num_ratings
FROM actor ac
JOIN film_actor fa ON ac.actor_id = fa.actor_id
JOIN film f ON fa.film_id = f.film_id
GROUP BY ac.actor_id
ORDER BY num_ratings DESC
LIMIT 10;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,99,"SELECT",2024-04-13 16:02:12 KST,3/428,0,AUDIT,00000,"""
                    SELECT c.name AS category_name, COUNT(DISTINCT f.film_id) AS num_films, SUM(f.length) AS total_length, AVG(f.length) AS avg_length
FROM category c
JOIN film_category fc ON c.category_id = fc.category_id
JOIN film f ON fc.film_id = f.film_id
GROUP BY c.name
ORDER BY total_length DESC
LIMIT 5;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,100,"SELECT",2024-04-13 16:02:12 KST,3/429,0,AUDIT,00000,"""
                    SELECT ac.first_name, ac.last_name, COUNT(DISTINCT f.rating) AS num_ratings, COUNT(DISTINCT f.language_id) AS num_languages
FROM actor ac
JOIN film_actor fa ON ac.actor_id = fa.actor_id
JOIN film f ON fa.film_id = f.film_id
GROUP BY ac.actor_id
ORDER BY num_ratings DESC, num_languages DESC
LIMIT 10;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
2024-04-13 16:04:46.112 KST,"ags14","dvdrental",40580,"192.168.16.16:38676",661a2df4.9e84,101,"SELECT",2024-04-13 16:02:12 KST,3/430,0,AUDIT,00000,"""
                    SELECT c.first_name, c.last_name, COUNT(DISTINCT r.staff_id) AS num_staff_served, COUNT(DISTINCT a.district) AS num_districts_visited
FROM customer c
JOIN rental r ON c.customer_id = r.customer_id
JOIN staff s ON r.staff_id = s.staff_id
JOIN address a ON s.address_id = a.address_id
GROUP BY c.customer_id
ORDER BY num_staff_served DESC, num_districts_visited DESC
LIMIT 10;
                    """,,,,"SESSION",,,,,,,,"",,"READ","","statement"
